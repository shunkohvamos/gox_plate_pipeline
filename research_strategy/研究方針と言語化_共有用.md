# 研究の設計思想と言語化（外部AI・コード非参照者向け）

このプロジェクトの**設計思想**「どんな設計にしたいか」「なぜ絶対活性を入れるか」「t50/FoG/REA だけでは何が問題だったか」を、コードを読まない外部AIが理解できるように言語化した文書です。

---

## 1. 研究のゴールと、目指している設計

- **ゴール**: GOx の**活性を損なわずに**耐熱性を上げること。  
  「耐熱性だけ上げればよい」ではなく、**活性を落とさない（できれば維持・向上）** ことを前提にした最適化である。

- **目指している設計**:
  - 評価・最適化の**再現性と追跡可能性**を絶対条件とする（派生データはすべて生データに遡れる）。
  - 目的関数は**事前に固定**し、後から都合よく変えない（後付けに見えないようにする）。
  - 測定失敗・QC 不合格は**目的関数に埋め込まず**、制約・不可として**分離**して扱う。
  - 耐熱性は **FoG（t50 比）** で表す。生の t50（分）そのものを目的のスカラーにすることはしない（比で正規化した FoG を中核に置く）。

---

## 2. なぜ絶対活性（U0）を目的に入れるのか

### 2.1 絶対活性は「重要な軸」である

- 研究のゴールが **「活性を損なわずに耐熱性を上げる」** だから、**活性を損なっているかどうか**を評価に含めないと、ゴールと設計が一致しない。
- 「損なわずに」を**スコアに反映**するには、  
  「耐熱性が高い」だけでなく、  
  **「初期活性（U0）を維持している／上げている」ことをプラスに、「下げている」ことをマイナスに** 目的関数に含める必要がある。
- したがって、**絶対活性（初期活性 U0）は目的関数のもう一つの軸**として必須である。閾値で切るだけ（例: U0 ≥ 0.7 なら OK）では、「どこからが妥協か」が曖昧になり、かつ「維持・向上をプラスに評価する」というゴールをスコア上で表現できない。

### 2.2 設計上の方針

- 絶対活性は **連続量として** 目的に組み込む（下げればスコアが下がり、維持・向上すればスコアが上がる）。
- 主解析では **FoG\*** と **U0\*** の log 空間での線形結合 \( S = \log(\mathrm{FoG}^*) + \log(U_0^*) \) を事前固定し、これでランキングする。閾値は**補助的な感度分析**（例: U0* ≥ 0.7, 0.8, 0.9 での再ランキングとランク相関）としてのみ使い、主解析の定義は変えない。

---

## 3. t50 / FoG / REA だけでは何が問題だったか

### 3.1 安定性だけを最大化すると何が起きるか

- **t50 だけ**、**FoG だけ**、**REA だけ** を目的にすると、「耐熱性が高い候補」がトップに来る。
- しかし **初期活性が低い候補**（例: 熱には強いが元の活性がかなり落ちている）も、安定性指標だけなら**高く評価されてしまう**。
- 実際のデータでは、**FoG が高くても U0 が低い** 候補（PMTAC 型など）が存在する。こうした候補を「良い」とランクしてしまうと、**「活性を損なわずに耐熱性を上げる」という研究ゴールに反する**選択になる。

### 3.2 つまり何が不足していたか

- **t50 や FoG や REA だけ**の設計では、
  - 「活性を落としていないか」が目的に**反映されない**ため、
  - **高安定性・低活性**の候補が上位に出やすく、
  - 研究のゴール（活性を損なわずに耐熱性を上げる）と**整合しない**。
- そこで、**安定性の指標（FoG）に加えて、絶対活性（U0）を目的に組み込み**、「FoG を上げつつ U0 を維持・向上させる」方向にスコアが動くようにした。これが「t50/FoG/REA だけでは不十分だった」理由の言語化である。

### 3.3 FoG と t50 の役割の整理

- 目的関数の**安定性軸**に使っているのは **FoG（t50 比）** であり、生の t50（分）そのものではない。  
  t50 は FoG を計算するための**元になる量**であり、ランキングや BO の目的スカラーとしては **FoG（比）** を中核にしている。
- REA は反応性・活性の文脈で使う指標であり、**初期活性 U0** は「未処理・初期時点の活性」を表す別の軸として、目的関数では U0 を採用している（「絶対活性を損なわない」を評価するため）。

---

## 4. 目的関数まわりの設計思想（要約）

- **二軸を明示する**: 安定性（FoG）と絶対活性（U0）の両方を主解析のエンドポイントとして事前定義し、両方をスコアに含める。
- **連続スコアを主、閾値は補助**: 主解析は \( S = \log(\mathrm{FoG}^*) + \log(U_0^*) \) の連続スコアでランキングする。ハードな U0 閾値は感度分析のみで使う。
- **後付けを避ける**: スコアの形・重み・タイブレークは事前に固定し、感度分析（重みスイープ・閾値スイープ）で頑健性を示す。
- **制約と目的を分離する**: 測定不能・QC 不合格はスコアに 0 を埋め込まず、制約・不可として別扱いする。

---

## 5. 外部AIに渡すときの一文要約

> この研究のゴールは「GOx の活性を損なわずに耐熱性を上げる」ことである。そのため目的関数には**安定性（FoG, t50 比）だけでなく絶対活性（U0）を必ず含める**。t50/FoG/REA だけだと「高安定性・低活性」の候補が上位になり、ゴールと矛盾する。U0 を入れることで「耐熱性を上げつつ活性を維持・向上させる」方向にランキングが動くようにしている。主解析は事前固定の連続スコア \( S = \log(\mathrm{FoG}^*) + \log(U_0^*) \) で行い、閾値は補助的な感度分析のみに使う。測定失敗・QC 不合格は目的に埋め込まず制約として分離する。

---

## 6. 参照しているプロジェクト内ファイル

- 目的関数の詳細仕様: `research_strategy/Objective_strategy/objective_design_spec.md`, `objective_methods_paragraph.md`
- リサーチ結果・文献: `research_strategy/Objective_strategy/リサーチ結果.md`
- コア設計: `.cursor/rules/core-rules.mdc`, `AGENTS.md`
