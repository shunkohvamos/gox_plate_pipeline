---
alwaysApply: true
---

# コア設計憲法（熱耐性解析プロジェクト）

## 目的
このプロジェクトは「酵素熱耐性（t50/REA等）を再現可能に評価し、最適化に繋げる」ための解析基盤である。

## 非交渉ルール（絶対）
0) **コード把握は Serena 優先（トークン節約のため）**
- 要点把握・ナビゲーション・編集は **Serena MCP を先に使う**。ファイル全体の read は最終手段とし、トークン過剰使用を防ぐ。詳細は `Serena-MCP-priority.mdc` に従う。
- ユーザーの指定が Serena だけでは満たせない場合、またはユーザーが全文を読むよう指示した場合は、その指示に従う。

1) **再現性 / 追跡可能性（provenance）**
- すべての派生データ（CSV/TSV/JSON/図）は **生データ（raw）に追跡可能**でなければならない。
- 実行ごとに `run_id` を発行し、**すべての出力CSVに run_id 列を付与**する。
- 1実行につき1つの **run manifest（JSON）** を保存し、少なくとも以下を含める：
  - run_id, 実行時刻, git commit
  - 入力（raw/row_map/config等）の path, sha256, mtime, size
  - 実行パラメータ（CLI引数や主要設定）
- 集計値は「どのwell由来か」を追える **lineage（1行=1well）** を別CSVで出す（集計CSVに長い文字列で埋め込まない）。

2) **図の言語ポリシー**
- 図中のテキスト（タイトル/軸/凡例/注釈）は **英語のみ**。
- rawのフルパス等（日本語パスを含む可能性がある文字列）は図に埋め込まない。
- 図ファイル名には run_id を含め、追跡は manifest で行う。

3) **既存の数値定義は勝手に変えない**
- 初期傾き→絶対活性→REA 等の「定義」を変更する場合は、必ず理由・影響範囲・テスト更新をセットで行う。
- “見た目が良くなる” だけの理由で数値ロジックを変更しない。

## 変更時の必須チェック
- run_id / manifest / lineage の整合性が保たれていること
- 主要出力のスキーマ（列名）が崩れていないこと（必要なら正規化レイヤーで吸収）
- 図が英語のみになっていること
